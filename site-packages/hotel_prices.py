from bs4 import BeautifulSoup
import requests

def check_booking_com(url):
    headers = { "User-Agent": "Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/55.0.2883.87 Safari/537.36"}
    response = requests.get(url, headers = headers)
    soup = BeautifulSoup(response.text, 'html.parser')
    hotel_elements = soup.select("#hotellist_inner div.sr_item.sr_item_new")

    hotels = []
    
    for hotel_element in hotel_elements:
        discounted = False
        
        price = hotel_element.select_one("div.room_details table.featuredRooms td.roomPrice strong.price b")

        if price == None:
            price = hotel_element.select_one("div.room_details table.featuredRooms td.roomPrice span.rackrate") # un-discounted price
            discounted = True
            
            if price == None:
                    continue
        
        name = hotel_element.select_one("span.sr-hotel__name")
        score = hotel_element.select_one("span.average.js--hp-scorecard-scoreval")
        hotel = { 'name': name.text.strip(), 'score': score.text.strip(), 'price': price.text.strip()[4:], 'discounted': discounted }
        hotels.append(hotel)

    return hotels

        

        
